<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Confidence Intervals | Statistical Inference via Data Science</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Confidence Intervals | Statistical Inference via Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://nulib.github.io/moderndive_book/" />
  <meta property="og:image" content="https://nulib.github.io/moderndive_book/images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="nulib/moderndive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Confidence Intervals | Statistical Inference via Data Science" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://nulib.github.io/moderndive_book/images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay, Albert Y. Kim, Arend M. Kuyper, Elizabeth Tipton, and Kaitlyn Fitzgerald" />


<meta name="date" content="2019-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="6-sampling.html">
<link rel="next" href="8-inference-for-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec:intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#subsec:learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#subsec:pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#subsec:reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sec:intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#datacamp"><i class="fa fa-check"></i><b>1.3</b> DataCamp</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:connect-contribute"><i class="fa fa-check"></i><b>1.4</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#sec:about-book"><i class="fa fa-check"></i><b>1.5</b> About this book</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#sec:about-authors"><i class="fa fa-check"></i><b>1.6</b> About the authors</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i><b>1.6.1</b> Colophon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-getting-started.html"><a href="2-getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started with Data in R</a><ul>
<li class="chapter" data-level="2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-getting-started.html"><a href="2-getting-started.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-getting-started.html"><a href="2-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#code"><i class="fa fa-check"></i><b>2.2</b> How do I code in R?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>2.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#errors-warnings-and-messages"><i class="fa fa-check"></i><b>2.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#packages"><i class="fa fa-check"></i><b>2.3</b> What are R packages?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-getting-started.html"><a href="2-getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.3.1</b> Package installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-getting-started.html"><a href="2-getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.3.2</b> Package loading</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-getting-started.html"><a href="2-getting-started.html#package-use"><i class="fa fa-check"></i><b>2.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13"><i class="fa fa-check"></i><b>2.4</b> Explore your first dataset</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13-package"><i class="fa fa-check"></i><b>2.4.1</b> <code>nycflights13</code> package</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-getting-started.html"><a href="2-getting-started.html#flights-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> <code>flights</code> data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-getting-started.html"><a href="2-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>2.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-getting-started.html"><a href="2-getting-started.html#help-files"><i class="fa fa-check"></i><b>2.4.4</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-getting-started.html"><a href="2-getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-getting-started.html"><a href="2-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>2.5.1</b> Additional resources</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>2.5.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science via the tidyverse</b></span><ul>
<li class="chapter" data-level="" data-path="2-getting-started.html"><a href="2-getting-started.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.6" data-path="2-getting-started.html"><a href="2-getting-started.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.6</b> The Grammar of Graphics</a><ul>
<li class="chapter" data-level="2.6.1" data-path="2-getting-started.html"><a href="2-getting-started.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.6.1</b> Components of the Grammar</a></li>
<li class="chapter" data-level="2.6.2" data-path="2-getting-started.html"><a href="2-getting-started.html#gapminder"><i class="fa fa-check"></i><b>2.6.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.6.3" data-path="2-getting-started.html"><a href="2-getting-started.html#other-components"><i class="fa fa-check"></i><b>2.6.3</b> Other components</a></li>
<li class="chapter" data-level="2.6.4" data-path="2-getting-started.html"><a href="2-getting-started.html#ggplot2-package"><i class="fa fa-check"></i><b>2.6.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2-getting-started.html"><a href="2-getting-started.html#FiveNG"><i class="fa fa-check"></i><b>2.7</b> Five Named Graphs - The 5NG</a></li>
<li class="chapter" data-level="2.8" data-path="2-getting-started.html"><a href="2-getting-started.html#scatterplots"><i class="fa fa-check"></i><b>2.8</b> 5NG#1: Scatterplots</a><ul>
<li class="chapter" data-level="2.8.1" data-path="2-getting-started.html"><a href="2-getting-started.html#geompoint"><i class="fa fa-check"></i><b>2.8.1</b> Scatterplots via geom_point</a></li>
<li class="chapter" data-level="2.8.2" data-path="2-getting-started.html"><a href="2-getting-started.html#overplotting"><i class="fa fa-check"></i><b>2.8.2</b> Over-plotting</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-getting-started.html"><a href="2-getting-started.html#summary"><i class="fa fa-check"></i><b>2.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-getting-started.html"><a href="2-getting-started.html#linegraphs"><i class="fa fa-check"></i><b>2.9</b> 5NG#2: Linegraphs</a><ul>
<li class="chapter" data-level="2.9.1" data-path="2-getting-started.html"><a href="2-getting-started.html#geomline"><i class="fa fa-check"></i><b>2.9.1</b> Linegraphs via geom_line</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-getting-started.html"><a href="2-getting-started.html#summary-1"><i class="fa fa-check"></i><b>2.9.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2-getting-started.html"><a href="2-getting-started.html#histograms"><i class="fa fa-check"></i><b>2.10</b> 5NG#3: Histograms</a><ul>
<li class="chapter" data-level="2.10.1" data-path="2-getting-started.html"><a href="2-getting-started.html#geomhistogram"><i class="fa fa-check"></i><b>2.10.1</b> Histograms via geom_histogram</a></li>
<li class="chapter" data-level="2.10.2" data-path="2-getting-started.html"><a href="2-getting-started.html#adjustbins"><i class="fa fa-check"></i><b>2.10.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="2.10.3" data-path="2-getting-started.html"><a href="2-getting-started.html#summary-2"><i class="fa fa-check"></i><b>2.10.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="2-getting-started.html"><a href="2-getting-started.html#facets"><i class="fa fa-check"></i><b>2.11</b> Facets</a></li>
<li class="chapter" data-level="2.12" data-path="2-getting-started.html"><a href="2-getting-started.html#boxplots"><i class="fa fa-check"></i><b>2.12</b> 5NG#4: Boxplots</a><ul>
<li class="chapter" data-level="2.12.1" data-path="2-getting-started.html"><a href="2-getting-started.html#geomboxplot"><i class="fa fa-check"></i><b>2.12.1</b> Boxplots via geom_boxplot</a></li>
<li class="chapter" data-level="2.12.2" data-path="2-getting-started.html"><a href="2-getting-started.html#summary-3"><i class="fa fa-check"></i><b>2.12.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="2-getting-started.html"><a href="2-getting-started.html#geombar"><i class="fa fa-check"></i><b>2.13</b> 5NG#5: Barplots</a><ul>
<li class="chapter" data-level="2.13.1" data-path="2-getting-started.html"><a href="2-getting-started.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.13.1</b> Barplots via geom_bar or geom_col</a></li>
<li class="chapter" data-level="2.13.2" data-path="2-getting-started.html"><a href="2-getting-started.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>2.13.2</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="2.13.3" data-path="2-getting-started.html"><a href="2-getting-started.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.13.3</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.13.4" data-path="2-getting-started.html"><a href="2-getting-started.html#summary-4"><i class="fa fa-check"></i><b>2.13.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="2-getting-started.html"><a href="2-getting-started.html#conclusion-1"><i class="fa fa-check"></i><b>2.14</b> Conclusion</a><ul>
<li class="chapter" data-level="2.14.1" data-path="2-getting-started.html"><a href="2-getting-started.html#summary-table"><i class="fa fa-check"></i><b>2.14.1</b> Summary table</a></li>
<li class="chapter" data-level="2.14.2" data-path="2-getting-started.html"><a href="2-getting-started.html#argument-specification"><i class="fa fa-check"></i><b>2.14.2</b> Argument specification</a></li>
<li class="chapter" data-level="2.14.3" data-path="2-getting-started.html"><a href="2-getting-started.html#additional-resources-1"><i class="fa fa-check"></i><b>2.14.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.14.4" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.14.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.3</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.4</b> <code>group_by</code> rows</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.4.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.6</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#joins"><i class="fa fa-check"></i><b>3.7</b> <code>join</code> data frames</a><ul>
<li class="chapter" data-level="3.7.1" data-path="3-wrangling.html"><a href="3-wrangling.html#matching-key-variable-names"><i class="fa fa-check"></i><b>3.7.1</b> Matching “key” variable names</a></li>
<li class="chapter" data-level="3.7.2" data-path="3-wrangling.html"><a href="3-wrangling.html#diff-key"><i class="fa fa-check"></i><b>3.7.2</b> Different “key” variable names</a></li>
<li class="chapter" data-level="3.7.3" data-path="3-wrangling.html"><a href="3-wrangling.html#multiple-key-variables"><i class="fa fa-check"></i><b>3.7.3</b> Multiple “key” variables</a></li>
<li class="chapter" data-level="3.7.4" data-path="3-wrangling.html"><a href="3-wrangling.html#normal-forms"><i class="fa fa-check"></i><b>3.7.4</b> Normal forms</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#other-verbs"><i class="fa fa-check"></i><b>3.8</b> Other verbs</a><ul>
<li class="chapter" data-level="3.8.1" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.8.1</b> <code>select</code> variables</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.8.2</b> <code>rename</code> variables</a></li>
<li class="chapter" data-level="3.8.3" data-path="3-wrangling.html"><a href="3-wrangling.html#top_n-values-of-a-variable"><i class="fa fa-check"></i><b>3.8.3</b> <code>top_n</code> values of a variable</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#conclusion-2"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a><ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> Data Importing &amp; “Tidy” Data</a><ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#csv"><i class="fa fa-check"></i><b>4.1</b> Importing data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#using-the-console"><i class="fa fa-check"></i><b>4.1.1</b> Using the console</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#using-rstudios-interface"><i class="fa fa-check"></i><b>4.1.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.2</b> Tidy data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-tidy.html"><a href="4-tidy.html#definition-of-tidy-data"><i class="fa fa-check"></i><b>4.2.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.2.2</b> Converting to “tidy” data</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-tidy.html"><a href="4-tidy.html#nycflights13-package-1"><i class="fa fa-check"></i><b>4.2.3</b> <code>nycflights13</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.3</b> Case study: Democracy in Guatemala</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#conclusion-3"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.4.1</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.4.2</b> Additional resources</a></li>
<li class="chapter" data-level="4.4.3" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.4.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Modeling via moderndive</b></span><ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#needed-packages-3"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.5" data-path="4-tidy.html"><a href="4-tidy.html#model1"><i class="fa fa-check"></i><b>4.5</b> One numerical explanatory variable</a><ul>
<li class="chapter" data-level="4.5.1" data-path="4-tidy.html"><a href="4-tidy.html#model1EDA"><i class="fa fa-check"></i><b>4.5.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-tidy.html"><a href="4-tidy.html#model1table"><i class="fa fa-check"></i><b>4.5.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="4.5.3" data-path="4-tidy.html"><a href="4-tidy.html#model1points"><i class="fa fa-check"></i><b>4.5.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-tidy.html"><a href="4-tidy.html#model2"><i class="fa fa-check"></i><b>4.6</b> One categorical explanatory variable</a><ul>
<li class="chapter" data-level="4.6.1" data-path="4-tidy.html"><a href="4-tidy.html#model2EDA"><i class="fa fa-check"></i><b>4.6.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="4.6.2" data-path="4-tidy.html"><a href="4-tidy.html#model2table"><i class="fa fa-check"></i><b>4.6.2</b> Linear regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="4-tidy.html"><a href="4-tidy.html#model2points"><i class="fa fa-check"></i><b>4.6.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="4-tidy.html"><a href="4-tidy.html#related-topics"><i class="fa fa-check"></i><b>4.7</b> Related topics</a><ul>
<li class="chapter" data-level="4.7.1" data-path="4-tidy.html"><a href="4-tidy.html#correlationcoefficient"><i class="fa fa-check"></i><b>4.7.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="4.7.2" data-path="4-tidy.html"><a href="4-tidy.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>4.7.2</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="4.7.3" data-path="4-tidy.html"><a href="4-tidy.html#leastsquares"><i class="fa fa-check"></i><b>4.7.3</b> Best fitting line</a></li>
<li class="chapter" data-level="4.7.4" data-path="4-tidy.html"><a href="4-tidy.html#underthehood"><i class="fa fa-check"></i><b>4.7.4</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4-tidy.html"><a href="4-tidy.html#conclusion-4"><i class="fa fa-check"></i><b>4.8</b> Conclusion</a><ul>
<li class="chapter" data-level="4.8.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-4"><i class="fa fa-check"></i><b>4.8.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.8.2" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come-3"><i class="fa fa-check"></i><b>4.8.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html"><i class="fa fa-check"></i><b>5</b> Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#needed-packages-4"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model3"><i class="fa fa-check"></i><b>5.1</b> Two numerical explanatory variables</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>5.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>5.1.2</b> Multiple regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>5.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model4"><i class="fa fa-check"></i><b>5.2</b> One numerical &amp; one categorical explanatory variable</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>5.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>5.2.2</b> Multiple regression: Parallel slopes model</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>5.2.3</b> Multiple regression: Interaction model</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>5.2.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#related-topics-1"><i class="fa fa-check"></i><b>5.3</b> Related topics</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#correlationcoefficient2"><i class="fa fa-check"></i><b>5.3.1</b> More on the correlation coefficient</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#simpsonsparadox"><i class="fa fa-check"></i><b>5.3.2</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#conclusion-5"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#additional-resources-5"><i class="fa fa-check"></i><b>5.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Inference via infer</b></span><ul>
<li class="chapter" data-level="5.5" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#terminology"><i class="fa fa-check"></i><b>5.5</b> Terminology &amp; Notation</a></li>
<li class="chapter" data-level="5.6" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#sample_selection"><i class="fa fa-check"></i><b>5.6</b> Populations &amp; Sampling</a></li>
<li class="chapter" data-level="5.7" data-path="5-multiple-regression.html"><a href="5-multiple-regression.html#samples"><i class="fa fa-check"></i><b>5.7</b> Samples &amp; Populations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-sampling.html"><a href="6-sampling.html"><i class="fa fa-check"></i><b>6</b> Sampling Distributions</a><ul>
<li class="chapter" data-level="" data-path="6-sampling.html"><a href="6-sampling.html#needed-packages-5"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-sampling.html"><a href="6-sampling.html#theory"><i class="fa fa-check"></i><b>6.1</b> Theory of Repeated Samples</a></li>
<li class="chapter" data-level="6.2" data-path="6-sampling.html"><a href="6-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>6.2</b> Sampling Activity</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-sampling.html"><a href="6-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>6.2.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-sampling.html"><a href="6-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>6.2.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-sampling.html"><a href="6-sampling.html#student-shovels"><i class="fa fa-check"></i><b>6.2.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="6.2.4" data-path="6-sampling.html"><a href="6-sampling.html#what-are-we-doing-here"><i class="fa fa-check"></i><b>6.2.4</b> What are we doing here?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-sampling.html"><a href="6-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>6.3</b> Computer simulation</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-sampling.html"><a href="6-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>6.3.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-sampling.html"><a href="6-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>6.3.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-sampling.html"><a href="6-sampling.html#using-the-virtual-shovel-1000-times"><i class="fa fa-check"></i><b>6.3.3</b> Using the virtual shovel 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-sampling.html"><a href="6-sampling.html#properties_s"><i class="fa fa-check"></i><b>6.4</b> Properties of Sampling Distributions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-sampling.html"><a href="6-sampling.html#dist"><i class="fa fa-check"></i><b>6.4.1</b> Distribution</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-sampling.html"><a href="6-sampling.html#bias"><i class="fa fa-check"></i><b>6.4.2</b> Mean of the sampling distribution</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-sampling.html"><a href="6-sampling.html#precision"><i class="fa fa-check"></i><b>6.4.3</b> Standard deviation of the sampling distribution</a></li>
<li class="chapter" data-level="6.4.4" data-path="6-sampling.html"><a href="6-sampling.html#conf"><i class="fa fa-check"></i><b>6.4.4</b> Confusing concepts</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-sampling.html"><a href="6-sampling.html#size"><i class="fa fa-check"></i><b>6.5</b> Sample Size and Sampling Distributions</a><ul>
<li class="chapter" data-level="6.5.1" data-path="6-sampling.html"><a href="6-sampling.html#eg1"><i class="fa fa-check"></i><b>6.5.1</b> Sampling balls with different sized shovels</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-sampling.html"><a href="6-sampling.html#clt"><i class="fa fa-check"></i><b>6.6</b> Central Limit Theorem (CLT)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-CIs.html"><a href="7-CIs.html"><i class="fa fa-check"></i><b>7</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="7-CIs.html"><a href="7-CIs.html#needed-packages-6"><i class="fa fa-check"></i>Needed Packages</a></li>
<li class="chapter" data-level="7.1" data-path="6-sampling.html"><a href="6-sampling.html#theory"><i class="fa fa-check"></i><b>7.1</b> Theory based upon assumptions and models</a></li>
<li class="chapter" data-level="7.2" data-path="7-CIs.html"><a href="7-CIs.html#bootstrap"><i class="fa fa-check"></i><b>7.2</b> Bootstrap</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-CIs.html"><a href="7-CIs.html#bootstrapping-example"><i class="fa fa-check"></i><b>7.2.1</b> Bootstrapping Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="7-CIs.html"><a href="7-CIs.html#bootstrap-process"><i class="fa fa-check"></i><b>7.2.2</b> The Bootstrapping Process</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-CIs.html"><a href="7-CIs.html#the-infer-package-for-statistical-inference"><i class="fa fa-check"></i><b>7.3</b> The infer package for statistical inference</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-CIs.html"><a href="7-CIs.html#specify-variables"><i class="fa fa-check"></i><b>7.3.1</b> Specify variables</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-CIs.html"><a href="7-CIs.html#generate-replicates"><i class="fa fa-check"></i><b>7.3.2</b> Generate replicates</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-CIs.html"><a href="7-CIs.html#calculate-summary-statistics"><i class="fa fa-check"></i><b>7.3.3</b> Calculate summary statistics</a></li>
<li class="chapter" data-level="7.3.4" data-path="7-CIs.html"><a href="7-CIs.html#visualize-the-results"><i class="fa fa-check"></i><b>7.3.4</b> Visualize the results</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-CIs.html"><a href="7-CIs.html#combining-an-estimate-with-its-precision"><i class="fa fa-check"></i><b>7.4</b> Combining an estimate with its precision</a><ul>
<li class="chapter" data-level="7.4.1" data-path="7-CIs.html"><a href="7-CIs.html#confidence-interval-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4.1</b> Confidence Interval with the Normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-CIs.html"><a href="7-CIs.html#confidence-interval-via-bootstrap"><i class="fa fa-check"></i><b>7.5</b> Confidence Interval via Bootstrap</a></li>
<li class="chapter" data-level="7.6" data-path="7-CIs.html"><a href="7-CIs.html#interpreting-a-confidence-interval"><i class="fa fa-check"></i><b>7.6</b> Interpreting a Confidence Interval</a></li>
<li class="chapter" data-level="7.7" data-path="7-CIs.html"><a href="7-CIs.html#one-prop-ci"><i class="fa fa-check"></i><b>7.7</b> Example: One proportion</a><ul>
<li class="chapter" data-level="7.7.1" data-path="7-CIs.html"><a href="7-CIs.html#observed-statistic"><i class="fa fa-check"></i><b>7.7.1</b> Observed Statistic</a></li>
<li class="chapter" data-level="7.7.2" data-path="7-CIs.html"><a href="7-CIs.html#bootstrap-distribution"><i class="fa fa-check"></i><b>7.7.2</b> Bootstrap distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="7-CIs.html"><a href="7-CIs.html#example-comparing-two-proportions"><i class="fa fa-check"></i><b>7.8</b> Example: Comparing two proportions</a><ul>
<li class="chapter" data-level="7.8.1" data-path="7-CIs.html"><a href="7-CIs.html#compute-the-point-estimate"><i class="fa fa-check"></i><b>7.8.1</b> Compute the point estimate</a></li>
<li class="chapter" data-level="7.8.2" data-path="7-CIs.html"><a href="7-CIs.html#bootstrap-distribution-1"><i class="fa fa-check"></i><b>7.8.2</b> Bootstrap distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html"><i class="fa fa-check"></i><b>8</b> Inference for Regression</a><ul>
<li class="chapter" data-level="" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#needed-packages-7"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#simulation-based-inference-for-regression"><i class="fa fa-check"></i><b>8.1</b> Simulation-based Inference for Regression</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#data"><i class="fa fa-check"></i><b>8.1.1</b> Data</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#test-statistic-delta"><i class="fa fa-check"></i><b>8.1.2</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#observed-effect-delta"><i class="fa fa-check"></i><b>8.1.3</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="8.1.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#model-of-h_0"><i class="fa fa-check"></i><b>8.1.4</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.1.5" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#simulated-data"><i class="fa fa-check"></i><b>8.1.5</b> Simulated data</a></li>
<li class="chapter" data-level="8.1.6" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#distribution-of-delta-under-h_0"><i class="fa fa-check"></i><b>8.1.6</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.1.7" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#the-p-value"><i class="fa fa-check"></i><b>8.1.7</b> The p-value</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#bootstrapping-for-the-regression-slope"><i class="fa fa-check"></i><b>8.2</b> Bootstrapping for the regression slope</a></li>
<li class="chapter" data-level="8.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#inference-for-multiple-regression"><i class="fa fa-check"></i><b>8.3</b> Inference for multiple regression</a><ul>
<li class="chapter" data-level="8.3.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#refresher-professor-evaluations-data"><i class="fa fa-check"></i><b>8.3.1</b> Refresher: Professor evaluations data</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#refresher-visualizations"><i class="fa fa-check"></i><b>8.3.2</b> Refresher: Visualizations</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#refresher-regression-tables"><i class="fa fa-check"></i><b>8.3.3</b> Refresher: Regression tables</a></li>
<li class="chapter" data-level="8.3.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#script-of-r-code"><i class="fa fa-check"></i><b>8.3.4</b> Script of R code</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#residual-analysis"><i class="fa fa-check"></i><b>8.4</b> Residual analysis</a><ul>
<li class="chapter" data-level="8.4.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#model1residuals"><i class="fa fa-check"></i><b>8.4.1</b> Residual analysis</a></li>
<li class="chapter" data-level="8.4.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#model2residuals"><i class="fa fa-check"></i><b>8.4.2</b> Residual analysis</a></li>
<li class="chapter" data-level="8.4.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#model3residuals"><i class="fa fa-check"></i><b>8.4.3</b> Residual analysis</a></li>
<li class="chapter" data-level="8.4.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#model4residuals"><i class="fa fa-check"></i><b>8.4.4</b> Residual analysis</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span><ul>
<li class="chapter" data-level="" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#needed-packages-8"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.5" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#seattle-house-prices"><i class="fa fa-check"></i><b>8.5</b> Case study: Seattle house prices</a><ul>
<li class="chapter" data-level="8.5.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#house-prices-EDA-I"><i class="fa fa-check"></i><b>8.5.1</b> Exploratory data analysis (EDA)</a></li>
<li class="chapter" data-level="8.5.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#log10-transformations"><i class="fa fa-check"></i><b>8.5.2</b> log10 transformations</a></li>
<li class="chapter" data-level="8.5.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#eda-part-ii"><i class="fa fa-check"></i><b>8.5.3</b> EDA Part II</a></li>
<li class="chapter" data-level="8.5.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#house-prices-regression"><i class="fa fa-check"></i><b>8.5.4</b> Regression modeling</a></li>
<li class="chapter" data-level="8.5.5" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#house-prices-inference-for-regression"><i class="fa fa-check"></i><b>8.5.5</b> Inference for regression</a></li>
<li class="chapter" data-level="8.5.6" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#house-prices-making-predictions"><i class="fa fa-check"></i><b>8.5.6</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#data-journalism"><i class="fa fa-check"></i><b>8.6</b> Case study: Effective data storytelling</a><ul>
<li class="chapter" data-level="8.6.1" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#bechdel-test-for-hollywood-gender-representation"><i class="fa fa-check"></i><b>8.6.1</b> Bechdel test for Hollywood gender representation</a></li>
<li class="chapter" data-level="8.6.2" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#us-births-in-1999"><i class="fa fa-check"></i><b>8.6.2</b> US Births in 1999</a></li>
<li class="chapter" data-level="8.6.3" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#other-examples"><i class="fa fa-check"></i><b>8.6.3</b> Other examples</a></li>
<li class="chapter" data-level="8.6.4" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#script-of-r-code-1"><i class="fa fa-check"></i><b>8.6.4</b> Script of R code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="8-inference-for-regression.html"><a href="8-inference-for-regression.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#normal-distribution-discussion"><i class="fa fa-check"></i><b>A.2</b> Normal distribution discussion</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-9"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a><ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a><ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#check-conditions-2"><i class="fa fa-check"></i><b>B.4.6</b> Check conditions</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.7</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a><ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a><ul>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Reach for the Stars</a><ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-10"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#sorted-barplots"><i class="fa fa-check"></i><b>C.1</b> Sorted barplots</a></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="D-appendixD.html"><a href="D-appendixD.html"><i class="fa fa-check"></i><b>D</b> Learning Check Solutions</a><ul>
<li class="chapter" data-level="D.1" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-2-solutions"><i class="fa fa-check"></i><b>D.1</b> Chapter 2 Solutions</a></li>
<li class="chapter" data-level="D.2" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-3-solutions"><i class="fa fa-check"></i><b>D.2</b> Chapter 3 Solutions</a></li>
<li class="chapter" data-level="D.3" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-4-solutions"><i class="fa fa-check"></i><b>D.3</b> Chapter 4 Solutions</a></li>
<li class="chapter" data-level="D.4" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-5-solutions"><i class="fa fa-check"></i><b>D.4</b> Chapter 5 Solutions</a></li>
<li class="chapter" data-level="D.5" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-6-solutions"><i class="fa fa-check"></i><b>D.5</b> Chapter 6 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference via Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="CIs" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Confidence Intervals</h1>
<p>In Chapter <a href="6-sampling.html#sampling">6</a>, we developed a theory of repeated samples. But what does this mean for your data analysis? If you only have one sample in front of you, how are you supposed to understand properties of the sampling distribution and your estimators? In this chapter we tackle these questions using two approaches: 1) based upon formulas provided to us via mathematical theory, and 2) based upon approximations available computationally (bootstrap).</p>
<div id="needed-packages-6" class="section level3 unnumbered">
<h3>Needed Packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). If needed, read Section <a href="2-getting-started.html#packages">2.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(janitor)
<span class="kw">library</span>(moderndive)
<span class="kw">library</span>(infer)</code></pre></div>
</div>
<div id="theory" class="section level2">
<h2><span class="header-section-number">7.1</span> Theory based upon assumptions and models</h2>
<p>In the table below, we provide some basic properties of common sampling statistics you are likely to encounter in this course. (How do we know these properties are true? These have been proven mathematically by statisticians.)</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:SE-table">TABLE 7.1: </span>Properties of Sample Statistics
</caption>
<thead>
<tr>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Sample statistic
</th>
<th style="text-align:left;">
Biased?
</th>
<th style="text-align:left;">
SE of sample statistic
</th>
<th style="text-align:left;">
Distribution (small n)
</th>
<th style="text-align:left;">
Distribution (large n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 0.5in; ">
Proportion
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\pi\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{\pi}\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\frac{\hat{\pi}(1-\hat{\pi})}{\sqrt{n}}\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Mean
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Variance
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\sigma^2\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(s^2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
?
</td>
<td style="text-align:left;">
Chi-squared
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Difference in proportions
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\pi_1 -\pi_2\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{\pi}_1 - \widehat{\pi}_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\sqrt{\frac{\pi_1(1-\pi_1)}{n_1} + \frac{\pi_2(1 - \pi_2)}{n_2}}\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Difference in means
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Regression intercept
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(b_0\)</span> or <span class="math inline">\(\widehat{\beta}_0\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(s^2[\frac{1}{n} + \frac{\bar{x}^2}{(n-1)s_x^2}]\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
<tr>
<td style="text-align:left;width: 0.5in; ">
Regression slope
</td>
<td style="text-align:left;width: 0.7in; ">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(b_1\)</span> or <span class="math inline">\(\widehat{\beta}_1\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Unbiased
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\sqrt{\frac{s_y^2}{(n-1)s_x^2}}\)</span>
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Normal
</td>
</tr>
</tbody>
</table>
<p>As an example, let’s say you are trying to estimate the population average age at the football game <span class="math inline">\(\mu\)</span>. Let’s use our simulated <code>football_fans</code> dataset again that has information on the whole population of 40,000 fans.</p>
<!-- change seed in chapter 9 to 2018 for the football fan data. This results in a better example to demonstrate CIs later on-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
football_fans &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">home_fan =</span> <span class="kw">rbinom</span>(<span class="dv">40000</span>, <span class="dv">1</span>, <span class="fl">0.91</span>),
                            <span class="dt">age =</span> <span class="kw">rnorm</span>(<span class="dv">40000</span>, <span class="dv">30</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="kw">case_when</span>(age <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,
                         age <span class="op">&gt;=</span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>age))
sample_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">sample_n</span>(football_fans, <span class="dt">size =</span> <span class="dv">10</span>)
<span class="kw">mean</span>(sample_<span class="dv">10</span><span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 28.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(sample_<span class="dv">10</span><span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 133</code></pre>
<p>To estimate the average age, you take a sample of <span class="math inline">\(n = 10\)</span> participants, producing an estimate of <span class="math inline">\(\bar{x} =\)</span> 28.5 years old. Your question is simply: is this a good estimate?</p>
<ul>
<li>The estimator here is the sample mean, <span class="math inline">\(\bar{x}\)</span>.</li>
<li>We know that the sample mean provides an unbiased estimate of the population mean. In the average possible sample, this statistic will be right.</li>
<li>We know that the sampling distribution of the sample mean is the normal distribution. This is unimodal and symmetric, meaning that our estimate is just as likely larger than this population mean as it is smaller.</li>
<li>The standard error of a sample mean is <span class="math inline">\(SE(\bar{x}) = s/\sqrt{n}\)</span>. In this sample, since <span class="math inline">\(s^2 =\)</span> 133.2, we can calculate this standard error to be <span class="math inline">\(SE(\bar{x}) =\)</span> 133.2<span class="math inline">\(/\sqrt{10} =\)</span> 3.65. Note that a standard error is always in the same units as the original variable, so in this case the standard error is 3.65 <em>years</em>. Comparing this to the sample mean (<span class="math inline">\(\bar{x} =\)</span> 28.5) this gives us a sense that we are somewhat close to the true parameter value.</li>
</ul>
<p>Note that we can extend the above properties to <em>differences</em> between groups as well. In general,</p>
<ul>
<li><span class="math inline">\(Bias(X_1 - X_2) = Bias(X_1) - Bias(X_2) \dashrightarrow\)</span> If <span class="math inline">\(X_1, X_2\)</span> are unbiased, then <span class="math inline">\(X_1 - X_2\)</span> is also unbiased.</li>
<li>So long as <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent, $ SE(X_1 – X_2) = $</li>
<li><span class="math inline">\(Dist(X_1 - X_2) \dashrightarrow\)</span> if <span class="math inline">\(X_1, X_2\)</span> are independent, then <span class="math inline">\(X_1 – X_2\)</span> are independent.</li>
</ul>
<p>This may seem really abstract. As an example, let’s focus on estimating the difference means between two groups in the population <span class="math inline">\((\mu_1 - \mu_2)\)</span>. In our <code>football_fans</code> example, we could consider whether there is a difference in average age between home fans and away fans, so <span class="math inline">\(\mu_1\)</span> refers here to the average age of all home fans in the population, and <span class="math inline">\(\mu_2\)</span> refers to the average age of all away fans in the population. We can estimate this difference in average age using <span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span> in our sample, where <span class="math inline">\(\bar{x}_1\)</span> is the average age of home fans in our sample and <span class="math inline">\(\bar{x}_2\)</span> is the average age of away fans in our sample. Using information in Table <a href="7-CIs.html#tab:SE-table">7.1</a> above, because <span class="math inline">\(\bar{x}_1\)</span> is and unbiased estimator for <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\bar{x}_2\)</span> is an unbiased estimator for <span class="math inline">\(mu_2\)</span>, we have:</p>
<p><span class="math display">\[Bias(\bar{x}_1 - \bar{x}_2) = Bias(\bar{x}_1) - Bias(\bar{x}_2) = 0\]</span> That is, on average, <span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span> will give us an unbiased estimate of <span class="math inline">\(\mu_1 - \mu_2\)</span>. Also, because the age of home fans is independent of the age of away fans, we have:</p>
<p><span class="math display">\[SE(\bar{x}_1 - \bar{x}_2) = \sqrt{[SE(\bar{x}_1)]^2 + [SE(\bar{x}_2)]^2} = \sqrt{(s_1^2/n_1 + s_2^2/n_2)}\]</span></p>
<p><span class="math display">\[\bar{x}_1 - \bar{x}_2 \sim normally \ \ distributed\]</span> Let’s demonstrate this with our <code>football_fans</code> data by drawing a random sample of <span class="math inline">\(n=100\)</span> fans and computing <span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
sample1_football_fans &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(football_fans, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">reps =</span> <span class="dv">1</span>)
mean_age_by_fan_type &lt;-<span class="st"> </span>sample1_football_fans <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(home_fan) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_age =</span> <span class="kw">mean</span>(age),
            <span class="dt">sd_age =</span> <span class="kw">sd</span>(age),
            <span class="dt">n =</span> <span class="kw">n</span>(),
            <span class="dt">SE_xbar =</span> sd_age <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))
mean_age_by_fan_type</code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   home_fan mean_age sd_age     n SE_xbar
##      &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1        0     29.3   8.59    15   2.22 
## 2        1     31.0   7.82    85   0.848</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diff_means &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(mean_age_by_fan_type[<span class="dv">1</span>,<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(mean_age_by_fan_type[<span class="dv">2</span>,<span class="dv">2</span>])
SE_diff_means &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">sqrt</span>(mean_age_by_fan_type[<span class="dv">1</span>, <span class="st">&quot;SE_xbar&quot;</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>mean_age_by_fan_type[<span class="dv">2</span>, <span class="st">&quot;SE_xbar&quot;</span>]<span class="op">^</span><span class="dv">2</span>))
SE_diff_means</code></pre></div>
<pre><code>## [1] 2.38</code></pre>
<p>We see here that <span class="math inline">\(\bar{x}_1 - \bar{x}_2 =\)</span> -1.642 and <span class="math inline">\(SE(\bar{x}_1 - \bar{x}_2) =\)</span> 2.375. In our particular sample, home fans are older, but because the magnitude of our standard error is roughly 4 times the size of our point estimate, this indicates we have a relatively imprecise estimate.</p>
<p>We could also look at the sampling distribution of <span class="math inline">\(\bar{x}_1 - \bar{x}_2 =\)</span> by taking 10,000 repeated samples and computing the difference in means in each.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
samples_football_fans &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(football_fans, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">reps =</span> <span class="dv">10000</span>)
mean_age_by_fan_type &lt;-<span class="st"> </span>samples_football_fans <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(home_fan, replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_age =</span> <span class="kw">mean</span>(age)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> home_fan, <span class="dt">value =</span> mean_age) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;mean_age_away_fan&quot;</span> =<span class="st"> `</span><span class="dt">0</span><span class="st">`</span>, <span class="st">&quot;mean_age_home_fan&quot;</span> =<span class="st"> `</span><span class="dt">1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff_means =</span> mean_age_home_fan <span class="op">-</span><span class="st"> </span>mean_age_away_fan)

<span class="kw">ggplot</span>(mean_age_by_fan_type, <span class="kw">aes</span>(<span class="dt">x =</span> diff_means)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:diff-means"></span>
<img src="ismaykimkuyper_files/figure-html/diff-means-1.png" alt="Samping distribution of difference in means" width="\textwidth" />
<p class="caption">
FIGURE 7.1: Samping distribution of difference in means
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pop_mean_age_by_fan_type &lt;-<span class="st"> </span>football_fans <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(home_fan) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_age =</span> <span class="kw">mean</span>(age),
            <span class="dt">sd_age =</span> <span class="kw">sd</span>(age))
pop_mean_age_by_fan_type</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   home_fan mean_age sd_age
##      &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1        0     29.8   7.97
## 2        1     30.1   8.02</code></pre>
<p>We see that the sampling distribution of <span class="math inline">\(\bar{x}_1 - \bar{x}_2 =\)</span> follows a normal distribution centered around the true population mean <span class="math inline">\(\mu_1 - \mu_2 =\)</span> -0.277, as expected based on the properties presented in Table <a href="#SE-table"><strong>??</strong></a>.</p>
<p>What does this mean for your data analysis?</p>
<ul>
<li>You need to think about sample size and how it might affect the sampling distribution.</li>
<li>If you have a large enough sample (e.g., <span class="math inline">\(n &gt; 50\)</span>), you can probably assume the sampling distribution is normally distributed.</li>
<li>If you have a smaller sample (e.g., <span class="math inline">\(n &lt; 50\)</span>), you should look up what the appropriate sampling distribution would be (e.g., t-distribution, F-distribution).</li>
</ul>
<p>Importantly, what this does not mean is that you need to get a larger sample!</p>
</div>
<div id="bootstrap" class="section level2">
<h2><span class="header-section-number">7.2</span> Bootstrap</h2>
<p>The properties developed above are based on mathematical proofs. These proofs require assumptions, and it is sometimes hard to know if the assumptions have been met. Also, Table <a href="#SE-table"><strong>??</strong></a> only lists a small number of statistics. What if the parameter you are estimating requires a more complex estimator and you aren’t sure of its sampling distribution?</p>
<p>This problem provides the motivation for the <strong>bootstrap</strong>. The idea of the bootstrap is to approximate the sampling distribution of an estimator based upon the sample of data you have in front of you. The procedure is as follows:</p>
<ul>
<li>You have a sample size of <span class="math inline">\(n\)</span> (e.g., <span class="math inline">\(n = 100\)</span>)</li>
<li>Randomly select 1 observation and record its value. Return the observation to the sample. Now repeat this <span class="math inline">\(n\)</span> times. This is called <strong>sampling with replacement</strong> – note that in this procedure, the same observation may be selected multiple times, and other observations may not be selected at all.</li>
<li>For that simulated sample of size <span class="math inline">\(n\)</span>, calculate the sample statistic.</li>
<li>Repeat this process many, many, many (e.g., 10,000) times. Clearly, if you were to do this by hand this would be impossible. But this procedure can be conducted using a computer very quickly.</li>
</ul>
<p>At the end of this bootstrap procedure, you are able to see:</p>
<ul>
<li>An estimate of the sampling distribution</li>
<li>A <em>bootstrap</em> estimate of the standard error</li>
</ul>
<p>In cases in which there are also mathematical formulas available, bootstrap results should be very similar to those based off the formulas. When they are very different, however, this suggests that some of the assumptions used to develop the mathematical results might have been violated in the data.</p>
<div id="bootstrapping-example" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Bootstrapping Example</h3>
<p>Suppose we are interested in understanding some properties of the mean age of <strong>all</strong> US pennies from this data collected in 2011. How might we go about that? The <code>moderndive</code> package contains a sample of 40 pennies collected and minted in the United States. Let’s explore this sample data first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pennies_sample</code></pre></div>
<pre><code>## # A tibble: 40 x 2
##     year age_in_2011
##    &lt;int&gt;       &lt;int&gt;
##  1  1997          14
##  2  2006           5
##  3  1997          14
##  4  2000          11
##  5  2000          11
##  6  2007           4
##  7  1986          25
##  8  1980          31
##  9  1992          19
## 10  1993          18
## # … with 30 more rows</code></pre>
<p>The <code>pennies_sample</code> data frame has rows corresponding to a single penny with two variables:</p>
<ul>
<li><code>year</code> of minting as shown on the penny and</li>
<li><code>age_in_2011</code> giving the years the penny had been in circulation from 2011 as an integer, e.g. 15, 2, etc.</li>
</ul>
<p>Let’s begin by understanding some of the properties of <code>pennies_sample</code> using data wrangling tools from Chapter <a href="3-wrangling.html#wrangling">3</a> and data visualization from Chapter <a href="#viz"><strong>??</strong></a>.</p>
<p>First, let’s visualize the values in this sample as a histogram:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(pennies_sample, <span class="kw">aes</span>(<span class="dt">x =</span> age_in_<span class="dv">2011</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-7-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We see a slightly skewed distribution here that has quite a few values near 10 years in age with only a few larger than 35 years or smaller than 5 years. If <code>pennies_sample</code> is a representative sample from the population, we’d expect the age of all US pennies collected in 2011 to have a similar shape, a similar spread, and similar measures of central tendency like the mean.</p>
<p>So where does the mean value fall for this sample? This point will be known as our <strong>point estimate</strong> and provides us with a single number that could serve as the guess to what the true population mean age might be. Recall how to find this using the <code>dplyr</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x_bar &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(age_in_<span class="dv">2011</span>))
x_bar</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1  16.5</code></pre>
<p>Our point estimate is, thus, <span class="math inline">\(\bar{x} = 16.5\)</span>. Note that this is just one sample, though, providing just one guess at the population mean. What if we’d like to have another guess?</p>
<p>This should all sound similar to what we did in Chapter <a href="6-sampling.html#sampling">6</a>. There instead of collecting just a single scoop of balls we had many different students use the shovel to scoop different samples of red and white balls. We then calculated a sample statistic (the sample proportion) from each sample. But, we don’t have a population to pull from here with the pennies. We only have this one sample.</p>
<p>The process of <strong>bootstrapping</strong> allows us to use a single sample to generate many different samples that will act as our way of approximating a sampling distribution using a created <strong>bootstrap distribution</strong> instead.</p>
</div>
<div id="bootstrap-process" class="section level3">
<h3><span class="header-section-number">7.2.2</span> The Bootstrapping Process</h3>
<p>Remember that bootstrapping uses a process of random sampling <strong>with replacement</strong> from our original sample to create new <strong>bootstrap samples</strong> of the <em>same</em> size as our original sample. We can again make use of the <code>rep_sample_n()</code> function to explore what one such bootstrap sample would look like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_sample1 &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">40</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1</span>)
bootstrap_sample1</code></pre></div>
<pre><code>## # A tibble: 40 x 3
## # Groups:   replicate [1]
##    replicate  year age_in_2011
##        &lt;int&gt; &lt;int&gt;       &lt;int&gt;
##  1         1  1996          15
##  2         1  2000          11
##  3         1  1985          26
##  4         1  1977          34
##  5         1  1986          25
##  6         1  1977          34
##  7         1  1985          26
##  8         1  2007           4
##  9         1  1971          40
## 10         1  1985          26
## # … with 30 more rows</code></pre>
<p>Let’s visualize what this new bootstrap sample looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bootstrap_sample1, <span class="kw">aes</span>(<span class="dt">x =</span> age_in_<span class="dv">2011</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-11-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We now have another sample from what we could assume comes from the population of interest. We can similarly calculate the sample mean of this bootstrap sample, called a <strong>bootstrap statistic</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_sample1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(age_in_<span class="dv">2011</span>))</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   replicate  stat
##       &lt;int&gt; &lt;dbl&gt;
## 1         1  17.8</code></pre>
<p>We can see that this sample mean is larger than the <code>x_bar</code> value we calculated earlier for the <code>pennies_sample</code> data. We’ll come back to analyzing the different bootstrap statistic values shortly.</p>
<p>Let’s recap what was done to get to this bootstrap sample using a tactile explanation:</p>
<ol style="list-style-type: decimal">
<li>First, pretend that each of the 40 values of <code>age_in_2011</code> in <code>pennies_sample</code> were written on a small piece of paper. Recall that these values were 6, 30, 34, 19, 6, etc.</li>
<li>Now, put the 40 small pieces of paper into a receptacle such as a baseball cap.</li>
<li>Shake up the pieces of paper.</li>
<li>Draw “at random” from the cap to select one piece of paper.</li>
<li>Write down the value on this piece of paper. Say that it is 28.</li>
<li>Now, place this piece of paper containing 28 back into the cap.</li>
<li>Draw “at random” again from the cap to select a piece of paper. Note that this is the <em>sampling with replacement</em> part since you may draw 28 again.</li>
<li>Repeat this process until you have drawn 40 pieces of paper and written down the values on these 40 pieces of paper. Completing this repetition produces ONE bootstrap sample.</li>
</ol>
<p>If you look at the values in <code>bootstrap_sample1</code>, you can see how this process plays out. We originally drew 28, then we drew 11, then 7, and so on. Of course, we didn’t actually use pieces of paper and a cap here. We just had the computer perform this process for us to produce <code>bootstrap_sample1</code> using <code>rep_sample_n()</code> with <code>replace = TRUE</code> set.</p>
<p>The process of <em>sampling with replacement</em> is how we can use the original sample to take a guess as to what other values in the population may be. Sometimes in these bootstrap samples, we will select lots of larger values from the original sample, sometimes we will select lots of smaller values, and most frequently we will select values that are near the center of the sample. Let’s explore what the distribution of values of <code>age_in_2011</code> for six different bootstrap samples looks like to further understand this variability.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">six_bootstrap_samples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">40</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">6</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(six_bootstrap_samples, <span class="kw">aes</span>(<span class="dt">x =</span> age_in_<span class="dv">2011</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>replicate)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-14-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We can also look at the six different means using <code>dplyr</code> syntax:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">six_bootstrap_samples <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(age_in_<span class="dv">2011</span>))</code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   replicate  stat
##       &lt;int&gt; &lt;dbl&gt;
## 1         1  16.6
## 2         2  14.4
## 3         3  17.9
## 4         4  14.9
## 5         5  14.2
## 6         6  18.8</code></pre>
<p>Instead of doing this six times, we could do it 1000 times and then look at the distribution of <code>stat</code> across all 1000 of the <code>replicate</code>s. This sets the stage for the <code>infer</code> R package <span class="citation">(Bray et al. <a href="#ref-R-infer">2019</a>)</span> that was created to help users perform statistical inference such as confidence intervals and hypothesis tests using verbs similar to what you’ve seen with <code>dplyr</code>. We’ll walk through setting up each of the <code>infer</code> verbs for creating bootstrap sampling distributions using this <code>pennies_sample</code> example, while also explaining the purpose of the verbs in a general framework.</p>
</div>
</div>
<div id="the-infer-package-for-statistical-inference" class="section level2">
<h2><span class="header-section-number">7.3</span> The infer package for statistical inference</h2>
<p>The <code>infer</code> package makes great use of the <code>%&gt;%</code> to create a pipeline for statistical inference. The goal of the package is to provide a way for its users to explain the computational process of confidence intervals and hypothesis tests using the code as a guide. The verbs build in order here, so you’ll want to start with <code>specify()</code> and then continue through the others as needed.</p>
<div id="specify-variables" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Specify variables</h3>
<p><img src="images/flowcharts/infer/specify.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>The <code>specify()</code> function is used primarily to choose which variables will be the focus of the statistical inference. In addition, a setting of which variable will act as the <code>explanatory</code> and which acts as the <code>response</code> variable is done here. For proportion problems similar to those in Chapter <a href="6-sampling.html#sampling">6</a>, we can also give which of the different levels we would like to have as a <code>success</code>. We’ll see further examples of these options in this chapter, Chapter <a href="#hypothesis-testing"><strong>??</strong></a>, and in Appendix <a href="B-appendixB.html#appendixB">B</a>.</p>
<p>To begin to create a bootstrap sampling distribution for the population mean age of US pennies in 2011, we start by using <code>specify()</code> to choose which variable in our <code>pennies_sample</code> data we’d like to work with. This can be done in one of two ways:</p>
<ol style="list-style-type: decimal">
<li>Using the <code>response</code> argument:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> age_in_<span class="dv">2011</span>)</code></pre></div>
<pre><code>## Response: age_in_2011 (integer)
## # A tibble: 40 x 1
##    age_in_2011
##          &lt;int&gt;
##  1          14
##  2           5
##  3          14
##  4          11
##  5          11
##  6           4
##  7          25
##  8          31
##  9          19
## 10          18
## # … with 30 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Using <code>formula</code> notation:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> age_in_<span class="dv">2011</span> <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>)</code></pre></div>
<pre><code>## Response: age_in_2011 (integer)
## # A tibble: 40 x 1
##    age_in_2011
##          &lt;int&gt;
##  1          14
##  2           5
##  3          14
##  4          11
##  5          11
##  6           4
##  7          25
##  8          31
##  9          19
## 10          18
## # … with 30 more rows</code></pre>
<p>Note that the formula notation uses the common R methodology to include the response <span class="math inline">\(y\)</span> variable on the left of the <code>~</code> and the explanatory <span class="math inline">\(x\)</span> variable on the right of the “tilde.” Recall that you used this notation frequently with the <code>lm()</code> function in Chapters <a href="#regression"><strong>??</strong></a> and <a href="5-multiple-regression.html#multiple-regression">5</a> when fitting regression models. Either notation works just fine, but a preference is usually given here for the <code>formula</code> notation to further build on the ideas from earlier chapters.</p>
</div>
<div id="generate-replicates" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Generate replicates</h3>
<p><img src="images/flowcharts/infer/generate.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>After <code>specify()</code>ing the variables we’d like in our inferential analysis, we next feed that into the <code>generate()</code> verb. The <code>generate()</code> verb’s main argument is <code>reps</code>, which is used to give how many different repetitions one would like to perform. Another argument here is <code>type</code>, which is automatically determined by the kinds of variables passed into <code>specify()</code>. We can also be explicit and set this <code>type</code> to be <code>type = &quot;bootstrap&quot;</code>. This <code>type</code> argument will be further used in hypothesis testing in Chapter <a href="#hypothesis-testing"><strong>??</strong></a> as well. Make sure to check out <code>?generate</code> to see the options here and use the <code>?</code> operator to better understand other verbs as well.</p>
<p>Let’s <code>generate()</code> 1000 bootstrap samples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">thousand_bootstrap_samples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> age_in_<span class="dv">2011</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>)</code></pre></div>
<pre><code>## Setting `type = &quot;bootstrap&quot;` in `generate()`.</code></pre>
<p>We can use the <code>dplyr</code> <code>count()</code> function to help us understand what the <code>thousand_bootstrap_samples</code> data frame looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">thousand_bootstrap_samples <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(replicate)</code></pre></div>
<pre><code>## # A tibble: 1,000 x 2
## # Groups:   replicate [1,000]
##    replicate     n
##        &lt;int&gt; &lt;int&gt;
##  1         1    40
##  2         2    40
##  3         3    40
##  4         4    40
##  5         5    40
##  6         6    40
##  7         7    40
##  8         8    40
##  9         9    40
## 10        10    40
## # … with 990 more rows</code></pre>
<p>Notice that each <code>replicate</code> has 40 entries here. Now that we have 1000 different bootstrap samples, our next step is to <code>calculate</code> the bootstrap statistics for each sample.</p>
</div>
<div id="calculate-summary-statistics" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Calculate summary statistics</h3>
<p><img src="images/flowcharts/infer/calculate.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>After <code>generate()</code>ing many different samples, we next want to condense those samples down into a single statistic for each <code>replicate</code>d sample. As seen in the diagram, the <code>calculate()</code> function is helpful here.</p>
<p>As we did at the beginning of this chapter, we now want to calculate the mean <code>age_in_2011</code> for each bootstrap sample. To do so, we use the <code>stat</code> argument and set it to <code>&quot;mean&quot;</code> below. The <code>stat</code> argument has a variety of different options here and we will see further examples of this throughout the remaining chapters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> age_in_<span class="dv">2011</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>)</code></pre></div>
<pre><code>## Setting `type = &quot;bootstrap&quot;` in `generate()`.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution</code></pre></div>
<pre><code>## # A tibble: 1,000 x 2
##    replicate  stat
##        &lt;int&gt; &lt;dbl&gt;
##  1         1  15.6
##  2         2  17.4
##  3         3  18.1
##  4         4  17.8
##  5         5  19.6
##  6         6  15  
##  7         7  18.2
##  8         8  18.6
##  9         9  20.1
## 10        10  17.4
## # … with 990 more rows</code></pre>
<p>We see that the resulting data has 1000 rows and 2 columns corresponding to the 1000 replicates and the mean for each bootstrap sample.</p>
<div id="observed-statistic-point-estimate-calculations" class="section level4 unnumbered">
<h4>Observed statistic / point estimate calculations</h4>
<p>Just as <code>group_by() %&gt;% summarize()</code> produces a useful workflow in <code>dplyr</code>, we can also use <code>specify() %&gt;% calculate()</code> to compute summary measures on our original sample data. It’s often helpful both in confidence interval calculations, but also in hypothesis testing to identify what the corresponding statistic is in the original data. For our example on penny age, we computed above a value of <code>x_bar</code> using the <code>summarize()</code> verb in <code>dplyr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(age_in_<span class="dv">2011</span>))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1  16.5</code></pre>
<p>This can also be done by skipping the <code>generate()</code> step in the pipeline feeding <code>specify()</code> directly into <code>calculate()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pennies_sample <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> age_in_<span class="dv">2011</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1  16.5</code></pre>
<p>This shortcut will be particularly useful when the calculation of the observed statistic is tricky to do using <code>dplyr</code> alone. This is particularly the case when working with more than one variable as will be seen in Chapter <a href="#hypothesis-testing"><strong>??</strong></a>.</p>
</div>
</div>
<div id="visualize-the-results" class="section level3">
<h3><span class="header-section-number">7.3.4</span> Visualize the results</h3>
<p><img src="images/flowcharts/infer/visualize.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>The <code>visualize()</code> verb provides a simple way to view the bootstrap distribution as a histogram of the <code>stat</code> variable values. It has many other arguments that one can use as well including the shading of the histogram values corresponding to confidence interval values, which we will demonstrate later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>()</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-27-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>In this case, we can see that the bootstrap distribution provides us a guess as to what the variability in different sample means may look like only using the original sample as our guide. The shape of this resulting distribution appears to be normal, which is what we would expect given what we learned about the Central Limit Theorem in Section <a href="6-sampling.html#clt">6.6</a>.</p>
<p>The following diagram recaps the <code>infer</code> pipeline for creating a bootstrap distribution.</p>
<p><img src="images/flowcharts/infer/ci_diagram.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="combining-an-estimate-with-its-precision" class="section level2">
<h2><span class="header-section-number">7.4</span> Combining an estimate with its precision</h2>
<p>A <strong>confidence interval</strong> gives a range of plausible values for a parameter. It depends on a specified confidence level with higher confidence levels corresponding to wider confidence intervals and lower confidence levels corresponding to narrower confidence intervals. Common confidence levels include 90%, 95%, and 99%.</p>
<p>Usually we don’t just begin sections with a definition, but <em>confidence intervals</em> are simple to define and play an important role in the sciences and any field that uses data. You can think of a confidence interval as playing the role of a net when fishing. Using a single point-estimate to estimate an unknown parameter is like trying to catch a fish in a murky lake with a single spear, and using a confidence interval is like fishing with a net. We can throw a spear where we saw a fish, but we will probably miss. If we toss a net in that area, we have a good chance of catching the fish. Analogously, if we report a point estimate, we probably won’t hit the exact population parameter, but if we report a range of plausible values based around our statistic, we have a good shot at catching the parameter.</p>
<!--want to include the pic from the old slides to accompany the analogy? Also took language from the slides- need to be cited?-->
<div id="confidence-interval-with-the-normal-distribution" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Confidence Interval with the Normal distribution</h3>
<p>If the sampling distribution of an estimator is normally distributed, then we can use properties of the standard normal distribution to create a confidence interval. Recall that in the standard normal distribution:</p>
<ul>
<li>95% of the values are between -1.96 and +1.96.</li>
<li>90% of values are between -1.68 and +1.68.</li>
</ul>
<!--insert graphic of the empirical rule here?-->
<p>Using this, we can define a 95% confidence interval for a population parameter as, <span class="math display">\[(Estimate \ \ – \ 1.96*SE(Estimate),\ \ \ Estimate + 1.96*SE(Estimate))\]</span> For example, a 95% confidence interval for the population mean <span class="math inline">\(\mu\)</span> can be constructed based upon the sample mean as, <span class="math display">\[(\bar{x} - 1.96 * SE(\bar{x}), \ \bar{x} + 1.96*SE(\bar{x}))\]</span></p>
<p>In our penny example, our original sample <code>pennies_sample</code> had <span class="math inline">\(\bar{x} =\)</span> 16.5 and <span class="math inline">\(SE(\bar{x}) = \frac{s}{\sqrt{n}} =\)</span> 1.606, which gives a confidence interval of (13.35, 19.65).</p>
<p>A few properties are worth keeping in mind:</p>
<ul>
<li>This interval is <em>symmetric</em>. This symmetry follows from the fact that the normal distribution is a symmetric distribution. <em>If the sampling distribution is not normal, the confidence interval may not be symmetric</em>.</li>
<li>The multiplier 1.96 used in this interval corresponding to 95% comes directly from properties of the normal distribution. <em>If the sampling distribution is not normal, this multiplier might be different</em>. For example, this multiplier is <em>larger</em> when the distribution has heavy tails, as with the t-distribution. The multiplier will also be different if you want to use a level of confidence other than 95%.</li>
</ul>
<!--either here or as a class/homework exercise, could demonstrate the empirical rule / these cutoff values via simulations-->
</div>
</div>
<div id="confidence-interval-via-bootstrap" class="section level2">
<h2><span class="header-section-number">7.5</span> Confidence Interval via Bootstrap</h2>
<p>When you are not sure what the appropriate sampling distribution is, or when you are worried that your assumptions might be wrong, confidence intervals can be created using a bootstrapping process.</p>
<p>The bootstrapping process will provide bootstrap statistics that have a bootstrap distribution with the center at (or extremely close to) the mean of the original sample. This can be seen by giving the observed statistic <code>obs_stat</code> argument the value of the point estimate <code>x_bar</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>(<span class="dt">obs_stat =</span> x_bar)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-29-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We can also compute the mean of the bootstrap distribution of means to see how it compares to <code>x_bar</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_of_means =</span> <span class="kw">mean</span>(stat))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_of_means
##           &lt;dbl&gt;
## 1          16.6</code></pre>
<p>We can calculate a confidence interval for the unknown mean age of coins in 2011 via the bootsrap by using the middle 95% of the <code>bootstrap_distribution</code> to determine our endpoints. Our endpoints are thus at the 2.5<sup>th</sup> and 97.5<sup>th</sup> percentiles of the 1,000 bootsrapped sample means. This can be done with <code>infer</code> using the <code>get_ci()</code> function. (You can also use the <code>conf_int()</code> or <code>get_confidence_interval()</code> functions here as they are aliases that work the exact same way.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_ci</span>(<span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `2.5%` `97.5%`
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1   13.4      20</code></pre>
<p>These options are the default values for <code>level</code> and <code>type</code> so we can also just do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">percentile_ci &lt;-<span class="st"> </span>bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_ci</span>()
percentile_ci</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `2.5%` `97.5%`
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1   13.4      20</code></pre>
<p>Using this method, our range of plausible values for the mean age of US pennies in circulation in 2011 is 13.425 years to 20 years. We can use the <code>visualize()</code> function to view this using the <code>endpoints</code> and <code>direction</code> arguments, setting <code>direction</code> to <code>&quot;between&quot;</code> (between the values) and <code>endpoints</code> to be those stored with name <code>percentile_ci</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>(<span class="dt">endpoints =</span> percentile_ci, <span class="dt">direction =</span> <span class="st">&quot;between&quot;</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-33-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>You can see that 95% of the data stored in the <code>stat</code> variable in <code>bootstrap_distribution</code> falls between the two endpoints with 2.5% to the left outside of the shading and 2.5% to the right outside of the shading. The cut-off points that provide our range are shown with the darker lines.</p>
<p>Note that the function <code>get_ci()</code> in the <code>infer</code> package can be used to compute the confidence interval using the <span class="math inline">\(Estimate \ \pm \ multiplier*SE(Estimate)\)</span> formula, but the function is currently dependent on statistics being stored in the <code>stat</code> column created in the <code>calculate()</code> function, so you can only use <code>get_ci()</code> if you have used <code>infer</code> to create a bootstrap sampling distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_ci</span>(<span class="dt">type =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">point_estimate =</span> x_bar)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   lower upper
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  13.2  19.8</code></pre>
</div>
<div id="interpreting-a-confidence-interval" class="section level2">
<h2><span class="header-section-number">7.6</span> Interpreting a Confidence Interval</h2>
<p>Like many statistics, while a confidence interval is fairly straightforward to construct, it is very easy to interpret incorrectly. In fact, many researchers – statisticians included – get the interpretation of confidence intervals wrong. This goes back to the idea of <strong>counterfactual thinking</strong> that we introduced previously: a confidence interval is a property of a population and estimator, not a particular sample. It asks: if I constructed this interval in every possible sample, in what percentage of samples would I correctly include the true population parameter?</p>
<p>To see this, let’s return to the sampling distribution of the sample mean for our age of football fans example. Recall that we have simulated population data for all 40,000 fans and we took 10,000 repeated samples of size 100. Figure <a href="7-CIs.html#fig:samp-dist-mean">7.2</a> shows the sampling distribution of the sample mean. Recall that the true population mean is 30.064</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
samp_means_football_fans &lt;-<span class="st"> </span>samples_football_fans <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(age),
                                    <span class="dt">sd =</span> <span class="kw">sd</span>(age),
                                    <span class="dt">n =</span> <span class="kw">n</span>(),
                                    <span class="dt">se =</span> sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))

mu &lt;-<span class="st"> </span><span class="kw">mean</span>(football_fans<span class="op">$</span>age)
samp_dist_plot &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(samp_means_football_fans) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mean), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mu, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)
samp_dist_plot</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:samp-dist-mean"></span>
<img src="ismaykimkuyper_files/figure-html/samp-dist-mean-1.png" alt="Sampling Distribution of Average Age of Fans at a Football Game" width="\textwidth" />
<p class="caption">
FIGURE 7.2: Sampling Distribution of Average Age of Fans at a Football Game
</p>
</div>
<p>Assume that the sample we actually observed was <code>replicate = 437</code>, which had <span class="math inline">\(\bar{x} =\)</span> 29.838. If we used this sample mean to construct a 95% confidence interval, the population mean would be in this interval, right? Figure <a href="7-CIs.html#fig:samp-dist-mean-2">7.3</a> shows a confidence interval shaded around <span class="math inline">\(\bar{x} =\)</span> 29.838, which is indicated by the red line. This confidence interval successfully includes the true population mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xbar &lt;-<span class="st"> </span><span class="kw">filter</span>(samp_means_football_fans, replicate <span class="op">==</span><span class="st"> </span><span class="dv">437</span>)<span class="op">$</span>mean
xbar</code></pre></div>
<pre><code>## [1] 29.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="kw">filter</span>(samp_means_football_fans, replicate <span class="op">==</span><span class="st"> </span><span class="dv">437</span>)<span class="op">$</span>se
endpoints &lt;-<span class="st"> </span><span class="kw">c</span>(xbar <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>SE, xbar <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>SE)
samp_dist_plot <span class="op">+</span>
<span class="st">  </span><span class="kw">shade_ci</span>(endpoints) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> xbar, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:samp-dist-mean-2"></span>
<img src="ismaykimkuyper_files/figure-html/samp-dist-mean-2-1.png" alt="Confidence Interval shaded for an observed sample mean of 29.8" width="\textwidth" />
<p class="caption">
FIGURE 7.3: Confidence Interval shaded for an observed sample mean of 29.8
</p>
</div>
<p>Assume now that we were unlucky and drew a sample with a mean far from the population mean. One such case is <code>replicate =</code> 545, which had <span class="math inline">\(\bar{x} =\)</span> 32.275. In this case, is the population mean in this interval? Figure <a href="#samp-dist-mean-3"><strong>??</strong></a> displays this scenario.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xbar &lt;-<span class="st"> </span><span class="kw">filter</span>(samp_means_football_fans, replicate <span class="op">==</span><span class="st"> </span><span class="dv">545</span>)<span class="op">$</span>mean
SE &lt;-<span class="st"> </span><span class="kw">filter</span>(samp_means_football_fans, replicate <span class="op">==</span><span class="st"> </span><span class="dv">545</span>)<span class="op">$</span>se
endpoints &lt;-<span class="st"> </span><span class="kw">c</span>(xbar <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>SE, xbar <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>SE)
samp_dist_plot <span class="op">+</span>
<span class="st">  </span><span class="kw">shade_ci</span>(endpoints) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> xbar, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:samp-dist-mean-3"></span>
<img src="ismaykimkuyper_files/figure-html/samp-dist-mean-3-1.png" alt="Confidence Interval shaded for an observed sample mean of 32.3" width="\textwidth" />
<p class="caption">
FIGURE 7.4: Confidence Interval shaded for an observed sample mean of 32.3
</p>
</div>
<p>In this case, the confidence interval does not include the true population mean. Importantly, remember that in real life we only have the data in front of us from one sample. <em>We don’t know what the population mean is</em>, and we don’t know if our estimate is the value near to the mean (Figure <a href="#samp-dist-mean-2"><strong>??</strong></a> ) or far from the mean (Figure <a href="#samp-dist-mean-3"><strong>??</strong></a> ). Also recall <code>replicate =</code> 545 was a legitimate random sample drawn from the population of 40,000 football fans. Just by chance, it is possible to observe a sample mean that is far from the true population mean.</p>
<p>We could compute 95% confidence intervals for all 10,000 of our repeated samples, and we would expect approximately 95% of them to contain the true mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">mean</span>(football_fans<span class="op">$</span>age)
CIs_football_fans &lt;-<span class="st"> </span>samp_means_football_fans <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lb_95 =</span> mean <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se,
         <span class="dt">ub_95 =</span> mean <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se,
         <span class="dt">captured_95 =</span> lb_<span class="dv">95</span> <span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>mu <span class="op">&lt;=</span><span class="st"> </span>ub_<span class="dv">95</span>)
<span class="kw">sum</span>(CIs_football_fans<span class="op">$</span>captured_<span class="dv">95</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10000</span></code></pre></div>
<pre><code>## [1] 0.947</code></pre>
<p>In fact, 94.73% of the 10,000 do capture the true mean.</p>
<p>For visualization purposes, we’ll take a smaller subset of 100 of these confidence intervals and display the results in Figure <a href="#CI-fig"><strong>??</strong></a>. In this smaller subset, 96 of the 100 95% confidence intervals contain the true population mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)
CI_subset &lt;-<span class="st"> </span><span class="kw">sample_n</span>(CIs_football_fans, <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">replicate_id =</span> <span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>))
<span class="kw">ggplot</span>(CI_subset) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mean, <span class="dt">y =</span> replicate_id, <span class="dt">color =</span> captured_<span class="dv">95</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">y =</span> replicate_id, <span class="dt">yend =</span> replicate_id, <span class="dt">x =</span> lb_<span class="dv">95</span>, <span class="dt">xend =</span> ub_<span class="dv">95</span>, 
                   <span class="dt">color =</span> captured_<span class="dv">95</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="kw">expression</span>(<span class="st">&quot;Age in 2011 (Years)&quot;</span>),
    <span class="dt">y =</span> <span class="st">&quot;Replicate ID&quot;</span>,
    <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;95% percentile-based confidence intervals for &quot;</span>, 
                             mu, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))
  ) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mu, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:CI-fig"></span>
<img src="ismaykimkuyper_files/figure-html/CI-fig-1.png" alt="Confidence Interval for Average Age from 100 repeated samples of size 100" width="\textwidth" />
<p class="caption">
FIGURE 7.5: Confidence Interval for Average Age from 100 repeated samples of size 100
</p>
</div>
</div>
<div id="one-prop-ci" class="section level2">
<h2><span class="header-section-number">7.7</span> Example: One proportion</h2>
<p>Let’s revisit our exercise of trying to estimate the proportion of red balls in the bowl from Chapter <a href="6-sampling.html#sampling">6</a>. We are now interested in determining a confidence interval for population parameter <span class="math inline">\(\pi\)</span>, the proportion of balls that are red out of the total <span class="math inline">\(N = 2400\)</span> red and white balls.</p>
<p>We will use the first sample reported from Ilyas and Yohan in Subsection <a href="6-sampling.html#student-shovels">6.2.3</a> for our point estimate. They observed 21 red balls out of the 50 in their shovel. This data is stored in the <code>tactile_shovel1</code> data frame in the <code>moderndive</code> package.</p>
<!-- Need to include this in the pkg! -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tactile_shovel1</code></pre></div>
<pre><code>## # A tibble: 50 x 1
##    color
##    &lt;chr&gt;
##  1 white
##  2 red  
##  3 red  
##  4 red  
##  5 red  
##  6 red  
##  7 red  
##  8 white
##  9 red  
## 10 white
## # … with 40 more rows</code></pre>
<div id="observed-statistic" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Observed Statistic</h3>
<p>To compute the proportion that are red in this data we can use the <code>specify() %&gt;% calculate()</code> workflow. Note the use of the <code>success</code> argument here to clarify which of the two colors <code>&quot;red&quot;</code> or <code>&quot;white&quot;</code> we are interested in.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi_hat &lt;-<span class="st"> </span>tactile_shovel1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> color <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;prop&quot;</span>)
pi_hat</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1  0.42</code></pre>
</div>
<div id="bootstrap-distribution" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Bootstrap distribution</h3>
<p>Next we want to calculate many different bootstrap samples and their corresponding bootstrap statistic (the proportion of red balls). We’ve done 1000 in the past, but let’s go up to 10,000 now to better see the resulting distribution. Recall that this is done by including a <code>generate()</code> function call in the middle of our pipeline:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tactile_shovel1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> color <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">10000</span>)</code></pre></div>
<pre><code>## Setting `type = &quot;bootstrap&quot;` in `generate()`.</code></pre>
<p>This results in 50 rows for each of the 10,000 replicates. Lastly, we finish the infer pipeline by adding back in the <code>calculate()</code> step.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_props &lt;-<span class="st"> </span>tactile_shovel1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> color <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;prop&quot;</span>)</code></pre></div>
<p>Let’s <code>visualize()</code> what the resulting bootstrap distribution looks like as a histogram. We’ve adjusted the number of bins here as well to better see the resulting shape.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_props <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>(<span class="dt">bins =</span> <span class="dv">25</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-43-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We see that the resulting distribution is symmetric and bell-shaped so it doesn’t much matter which confidence interval method we choose. Let’s use the standard error method to create a 95% confidence interval.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">standard_error_ci &lt;-<span class="st"> </span>bootstrap_props <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_ci</span>(<span class="dt">type =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">point_estimate =</span> pi_hat)
standard_error_ci</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   lower upper
##   &lt;dbl&gt; &lt;dbl&gt;
## 1 0.284 0.556</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_props <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>(<span class="dt">bins =</span> <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">shade_ci</span>(<span class="dt">endpoints =</span> standard_error_ci, <span class="dt">color =</span> <span class="st">&quot;mediumaquamarine&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;turquoise&quot;</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-45-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We are 95% confident that the true proportion of red balls in the bowl is between 0.284 and 0.556. This level of confidence is based on the standard error-based method including the true proportion 95% of the time if many different samples (not just the one we used) were collected and confidence intervals were created.</p>
</div>
</div>
<div id="example-comparing-two-proportions" class="section level2">
<h2><span class="header-section-number">7.8</span> Example: Comparing two proportions</h2>
<p>If you see someone else yawn, are you more likely to yawn? In an <a href="http://www.discovery.com/tv-shows/mythbusters/mythbusters-database/yawning-contagious/">episode</a> of the show <em>Mythbusters</em>, they tested the myth that yawning is contagious. The snippet from the show is available to view in the United States on the Discovery Network website <a href="https://www.discovery.com/tv-shows/mythbusters/videos/is-yawning-contagious">here</a>. More information about the episode is also available on IMDb <a href="https://www.imdb.com/title/tt0768479/">here</a>.</p>
<p>Fifty adults who thought they were being considered for an appearance on the show were interviewed by a show recruiter (“confederate”) who either yawned or did not. Participants then sat by themselves in a large van and were asked to wait. While in the van, the Mythbusters watched via hidden camera to see if the unaware participants yawned. The data frame containing the results is available at <code>mythbusters_yawn</code> in the <code>moderndive</code> package. Let’s check it out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mythbusters_yawn</code></pre></div>
<pre><code>## # A tibble: 50 x 3
##     subj group   yawn 
##    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
##  1     1 seed    yes  
##  2     2 control yes  
##  3     3 seed    no   
##  4     4 seed    yes  
##  5     5 seed    no   
##  6     6 control no   
##  7     7 seed    yes  
##  8     8 control no   
##  9     9 control no   
## 10    10 seed    no   
## # … with 40 more rows</code></pre>
<ul>
<li>The participant ID is stored in the <code>subj</code> variable with values of 1 to 50.</li>
<li>The <code>group</code> variable is either <code>&quot;seed&quot;</code> for when a confederate was trying to influence the participant or <code>&quot;control&quot;</code> if a confederate did not interact with the participant.</li>
<li>The <code>yawn</code> variable is either <code>&quot;yes&quot;</code> if the participant yawned or <code>&quot;no&quot;</code> if the participant did not yawn.</li>
</ul>
<p>We can use the <code>janitor</code> package to get a glimpse into this data in a table format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tabyl</span>(group, yawn) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">adorn_percentages</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">adorn_pct_formatting</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># To show original counts</span>
<span class="st">  </span><span class="kw">adorn_ns</span>()</code></pre></div>
<pre><code>##    group         no        yes
##  control 75.0% (12) 25.0%  (4)
##     seed 70.6% (24) 29.4% (10)</code></pre>
<p>We are interested in comparing the proportion of those that yawned after seeing a seed versus those that yawned with no seed interaction. We’d like to see if the difference between these two proportions is significantly larger than 0. If so, we’d have evidence to support the claim that yawning is contagious based on this study.</p>
<p>In looking over this problem, we can make note of some important details to include in our <code>infer</code> pipeline:</p>
<ul>
<li>We are calling a <code>success</code> having a <code>yawn</code> value of <code>&quot;yes&quot;</code>.</li>
<li>Our response variable will always correspond to the variable used in the <code>success</code> so the response variable is <code>yawn</code>.</li>
<li>The explanatory variable is the other variable of interest here: <code>group</code>.</li>
</ul>
<p>To summarize, we are looking to see the examine the relationship between yawning and whether or not the participant saw a seed yawn or not.</p>
<div id="compute-the-point-estimate" class="section level3">
<h3><span class="header-section-number">7.8.1</span> Compute the point estimate</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group)</code></pre></div>
<pre><code>## Error: A level of the response variable `yawn` needs to be specified for the `success` argument in `specify()`.</code></pre>
<p>Note that the <code>success</code> argument must be specified in situations such as this where the response variable has only two levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>)</code></pre></div>
<pre><code>## Response: yawn (factor)
## Explanatory: group (factor)
## # A tibble: 50 x 2
##    yawn  group  
##    &lt;fct&gt; &lt;fct&gt;  
##  1 yes   seed   
##  2 yes   control
##  3 no    seed   
##  4 yes   seed   
##  5 no    seed   
##  6 no    control
##  7 yes   seed   
##  8 no    control
##  9 no    control
## 10 no    seed   
## # … with 40 more rows</code></pre>
<p>We next want to calculate the statistic of interest for our sample. This corresponds to the difference in the proportion of successes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>)</code></pre></div>
<pre><code>## Error: Statistic is based on a difference; specify the `order` in which to subtract the levels of the explanatory variable. `order = c(&quot;first&quot;, &quot;second&quot;)` means `(&quot;first&quot; - &quot;second&quot;)`. Check `?calculate` for details.</code></pre>
<p>We see another error here. To further check to make sure that R knows exactly what we are after, we need to provide the <code>order</code> in which R should subtract these proportions of successes. As the error message states, we’ll want to put <code>&quot;seed&quot;</code> first after <code>c()</code> and then <code>&quot;control&quot;</code>: <code>order = c(&quot;seed&quot;, &quot;control&quot;)</code>. Our point estimate is thus calculated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obs_diff &lt;-<span class="st"> </span>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;control&quot;</span>))
obs_diff</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     stat
##    &lt;dbl&gt;
## 1 0.0441</code></pre>
<p>This value represents the proportion of those that yawned after seeing a seed yawn (0.2941) minus the proportion of those that yawned with not seeing a seed (0.25).</p>
</div>
<div id="bootstrap-distribution-1" class="section level3">
<h3><span class="header-section-number">7.8.2</span> Bootstrap distribution</h3>
<p>Our next step in building a confidence interval is to create a bootstrap distribution of statistics (differences in proportions of successes). We saw how it works with both a single variable in computing bootstrap means in Subsection <a href="7-CIs.html#bootstrap-process">7.2.2</a> and in computing bootstrap proportions in Section <a href="7-CIs.html#one-prop-ci">7.7</a>, but we haven’t yet worked with bootstrapping involving multiple variables though.</p>
<p>In the <code>infer</code> package, bootstrapping with multiple variables means that each <strong>row</strong> is potentially resampled. Let’s investigate this by looking at the first few rows of <code>mythbusters_yawn</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mythbusters_yawn)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    subj group   yawn 
##   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
## 1     1 seed    yes  
## 2     2 control yes  
## 3     3 seed    no   
## 4     4 seed    yes  
## 5     5 seed    no   
## 6     6 control no</code></pre>
<p>When we bootstrap this data, we are potentially pulling the subject’s readings multiple times. Thus, we could see the entries of <code>&quot;seed&quot;</code> for <code>group</code> and <code>&quot;no&quot;</code> for <code>yawn</code> together in a new row in a bootstrap sample. This is further seen by exploring the <code>sample_n()</code> function in <code>dplyr</code> on this smaller 6 row data frame comprised of <code>head(mythbusters_yawn)</code>. The <code>sample_n()</code> function can perform this bootstrapping procedure and is similar to the <code>rep_sample_n()</code> function in <code>infer</code>, except that it is not <code>rep</code>eated but rather only performs one sample with or without replacement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2018</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mythbusters_yawn) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    subj group   yawn 
##   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
## 1     3 seed    no   
## 2     4 seed    yes  
## 3     5 seed    no   
## 4     2 control yes  
## 5     5 seed    no   
## 6     1 seed    yes</code></pre>
<p>We can see that in this bootstrap sample generated from the first six rows of <code>mythbusters_yawn</code>, we have some rows repeated. The same is true when we perform the <code>generate()</code> step in <code>infer</code> as done below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution &lt;-<span class="st"> </span>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;control&quot;</span>))</code></pre></div>
<pre><code>## Setting `type = &quot;bootstrap&quot;` in `generate()`.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">visualize</span>(<span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="ismaykimkuyper_files/figure-html/unnamed-chunk-56-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>This distribution is roughly symmetric and bell-shaped. Let’s use the percentile-based method to compute a 95% confidence interval for the true difference in the proportion of those that yawn with and without a seed presented. The arguments are explicitly listed here but remember they are the defaults and simply <code>get_ci()</code> can be used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_ci</span>(<span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `2.5%` `97.5%`
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1 -0.218   0.326</code></pre>
<p>The confidence interval shown here includes the value of 0. We’ll see in Chapter <a href="#hypothesis-testing"><strong>??</strong></a> further what this means in terms of this difference being statistically significant or not, but let’s examine a bit here first. The range of plausible values for the difference in the proportion of those that yawned with and without a seed is between -0.218 and 0.326.</p>
<p>Therefore, we are not sure which proportion is larger. Some of the bootstrap statistics showed the proportion without a seed to be higher and others showed the proportion with a seed to be higher. If the confidence interval was entirely above zero, we would be relatively sure (about “95% confident”) that the seed group had a higher proportion of yawning than the control group.</p>
<p>Note that this all relates to the importance of denoting the <code>order</code> argument in the <code>calculate()</code> function. Since we specified <code>&quot;seed&quot;</code> and then <code>&quot;control&quot;</code> positive values for the statistic correspond to the <code>&quot;seed&quot;</code> proportion being higher, whereas negative values correspond to the <code>&quot;control&quot;</code> group being higher.</p>
<p>We, therefore, have evidence via this confidence interval suggesting that the conclusion from the Mythbusters show that “yawning is contagious” being “confirmed” is not statistically appropriate.</p>
<!-- nothing in here yet about how sample size affects width of interval. should either include it or have it as an activity for them to explore in class/homework. I also have a shiny app for this https://kgfitz.shinyapps.io/confidence_intervals/ -->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-infer">
<p>Bray, Andrew, Chester Ismay, Ben Baumer, and Mine Cetinkaya-Rundel. 2019. <em>Infer: Tidy Statistical Inference</em>. <a href="https://CRAN.R-project.org/package=infer" class="uri">https://CRAN.R-project.org/package=infer</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="6-sampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-inference-for-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nulib/moderndive_book/edit/master/10-confidence-intervals.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
